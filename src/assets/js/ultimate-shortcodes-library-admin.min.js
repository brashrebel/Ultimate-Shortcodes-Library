var USL_Admin;!function(a){USL_Admin={init:function(){}},a(function(){USL_Admin.init()})}(jQuery);var USL_MCECallbacks;!function(a){USL_MCECallbacks={callbacks:{},_preShortcode:function(b){var c="",d='<span class="usl-tinymce-shortcode-code" data-code="'+b.shortcode+'"></span>';return b.atts&&(c+='<span class="usl-tinymce-shortcode-atts" data-atts=\'',a.each(b.atts,function(a,b){c+='"'+a+'": "'+b+'", '}),c+="'></span>"),"undefined"!=typeof b.preShortcode?b.preShortcode()+c+d:'<span class="usl-tinymce-shortcode-wrapper">'+c+d},_postShortcode:function(a){return"undefined"!=typeof a.postShortcode?a.postShortcode():"</span>"},_parseVisualContent:function(a,b){var c=new RegExp("(<p>)?(\\["+a.shortcode+".*].*\\[/"+a.shortcode+"])(<\\/p>)?","gi"),d=new RegExp("(<p>)?(\\["+a.shortcode+".*].*\\[/"+a.shortcode+"])(<\\/p>)?","i");if(-1!==b.indexOf("["+a.shortcode)){var e=b.match(c);if(e.length)for(var f=0;f<e.length;f++){var g=a.default_args?a.default_args:!1,h="";a.atts=USL_MCECallbacks.getAtts(e[f],g),a.shortcode_content=USL_MCECallbacks.getShortcodeContent(e[f]),a.showContent=USL_MCECallbacks._showContent,h+=USL_MCECallbacks._preShortcode(a),h+=a.callback(b),h+=USL_MCECallbacks._postShortcode(a),b=b.replace(d,h)}}return b},_parseTextContent:function(b,c){var d=new RegExp('<span class="usl-tinymce-shortcode-wrapper.*?>'+b.search.open+".*?"+b.search.close+"</span>","gi"),e=new RegExp('<span class="usl-tinymce-shortcode-wrapper.*?>'+b.search.open+".*?"+b.search.close+"</span>","i"),f=c.match(d);if(f)for(var g=0;g<f.length;g++){var h=USL_MCECallbacks._getVisualAtts(f[g]),i=USL_MCECallbacks._getVisualContent(f[g]),j=USL_MCECallbacks._getVisualCode(f[g]),k="["+j;h&&a.each(h,function(a,b){b.length&&(k+=" "+a+'="'+b+'"')}),k+="]",i.length&&(k+=i+"[/"+j+"]"),c=c.replace(e,k)}return c},getAtts:function(b,c){var d=b.match(/\s.*?(?==)/g),e=b.match(/"([^"]+)"/g),f={};if(null!==d)for(var g=0;g<d.length;g++)f[d[g].trim()]=e[g].substring(1,e[g].length-1);return c&&a.each(c,function(a,b){f[a]||(f[a]=b)}),f},getShortcodeContent:function(a){var b=a.match(/\](.*)\[/);return null!==b?b[1]:""},_interaction:function(a){var b="";b+='<span class="usl-tinymce-shortcode-interaction">',"undefined"!=typeof a.interaction?a.interaction():(b+='<span class="usl-tinymce-shortcode-interaction-edit"></span>',b+='<span class="usl-tinymce-shortcode-interaction-remove"></span>'),b+="</span>"},_getVisualAtts:function(a){var b=a.match(/<span class="usl-tinymce-shortcode-atts.*?data-atts="(.*?), ".*?<\/span>/i);return JSON.parse("{"+b[1].replace(/&quot;/gi,'"')+"}")},_getVisualContent:function(a){var b=a.match(/<span class="usl-tinymce-shortcode-content.*?>(.*?)<\/span>/i);return b[1]},_getVisualCode:function(a){var b=a.match(/<span class="usl-tinymce-shortcode-code.*?data-code="(.*?)".*?<\/span>/i);return b[1]},_showContent:function(a,b){var c=b.length?" "+b.join(" "):"";return'<span class="usl-tinymce-shortcode-content'+c+'">'+a+"</span>"}}}(jQuery),USL_MCECallbacks.callbacks.button={shortcode:"usl_button",search:{open:'<a class="usl-button',close:"</a>"},default_args:{link:"#",size:"medium",color:"#bada55",color_hover:"#84A347",font_color:"#fff",shape:"",icon:""},callback:function(){var a,b="";return b+=this.atts.size?"-"+this.atts.size:"",b+=this.atts.shape?"-"+this.atts.shape:"",a='<a class="usl-button'+b+'" href="'+this.atts.link+'"',a+=' style="background: '+this.atts.color+"; color: "+this.atts.font_color+'"',a+=">",a+='<span class="hover" style="background: '+this.atts.color_hover+'"></span>',a+=this.atts.icon?'<span class="icon dashicons '+this.atts.icon+'"></span>':"",a+=this.showContent(this.shortcode_content,["content"]),a+="</a>"}};var USL_Modal;!function(a){function b(){this.original_value=null,this.fieldname=null,this.shortcode=null,this.$container=null,this.$input=null,this.init=function(a){this.$container=a,this.$input=this.$container.find(".usl-modal-att-input"),this.fieldname=this.$container.find(".usl-modal-att-name").text().trim(),this.shortcode=this.$container.closest(".usl-modal-shortcode").attr("data-code"),this._storeOriginalValue()},this._storeOriginalValue=function(){this.original_value=this.$input.val(),this.storeOriginalValue()},this._revert=function(){this.$input.val(this.original_value),this.setValid(),this.revert()},this.getValue=function(){return this.$input.val()},this.setValue=function(a){this.$input.val(a)},this.setInvalid=function(a){this.$container.addClass("invalid"),this.errorMsg(a)},this.setValid=function(){this.$container.removeClass("invalid")},this.errorMsg=function(a){"undefined"==typeof this.$errormsg&&(this.$errormsg=this.$container.find(".usl-modal-att-errormsg")),this.$errormsg.html(a)},this.storeOriginalValue=function(){},this.revert=function(){}}var c,d,e,f={},g=!1;USL_Modal={output:"",init:function(){this.establishElements(),this.binds(),this.keyboardShortcuts(),this.attsInit(),this.preventWindowScroll(),this.search(),this.slidersInit(),this.colorpickersInit()},load:function(){},resize:function(){this.list_height()},establishElements:function(){f.wrap=a("#usl-modal-wrap"),f.submit=a("#usl-modal-submit"),f.backdrop=a("#usl-modal-backdrop"),f.cancel=f.wrap.find(".usl-modal-cancel"),f.close=f.wrap.find(".usl-modal-close"),f.title=f.wrap.find(".usl-modal-title"),f.search=f.wrap.find(".usl-modal-search"),f.categories=f.wrap.find(".usl-modal-categories"),f.footer=f.wrap.find(".usl-modal-footer"),f.list=f.wrap.find(".usl-modal-shortcodes"),f.active_shortcode="",f.search_input=f.wrap.find('input[name="usl-modal-search"]')},binds:function(){f.list.find(".accordion-section-title, .usl-modal-sc-title").click(function(){USL_Modal.activateShortcode(a(this))}),f.submit.off("click").click(function(a){a.preventDefault(),USL_Modal.update()}),f.cancel.click(function(a){a.preventDefault(),USL_Modal.close()}),f.close.click(function(a){a.preventDefault(),USL_Modal.close()}),f.categories.find("li").click(function(){USL_Modal.filterByCategory(a(this))}),f.list.find(".usl-modal-show-advanced-atts").click(function(){return USL_Modal.toggleAdvancedAtts(a(this)),!1})},keyboardShortcuts:function(){a(document).keyup(function(a){if(g){switch(a.which){case 13:USL_Modal.update();break;case 27:USL_Modal.close();break;case 40:var b=f.active_shortcode.next();b.length&&(USL_Modal.closeShortcode(),f.active_shortcode=b,USL_Modal.openShortcode());break;case 38:var c=f.active_shortcode.prev();c.length&&(USL_Modal.closeShortcode(),f.active_shortcode=c,USL_Modal.openShortcode())}13==a.which}})},attsInit:function(){f.list.find(".usl-modal-att-row").each(function(){var b,c=a(this).attr("data-att-type");switch(c){case"selectbox":b=new j(a(this));break;case"colorpicker":b=new k(a(this));break;case"slider":b=new l(a(this));break;default:b=new h(a(this))}a(this).data("attObj",b)})},colorpickersInit:function(){f.list.find(".usl-modal-att-colorpicker").each(function(){var b=a(this).data();a(this).wpColorPicker(b)})},slidersInit:function(){f.list.find(".usl-modal-att-slider").each(function(){var b=a(this),c=b.data(),d=b.siblings(".usl-modal-att-slider-value");c.slide=function(a,b){d.val(b.value)},d.change(function(){b.slider("value",a(this).val())}),b.slider(c)})},search:function(){var b,c=1e3,g=300;f.search_input.on("keyup",function(h){if(13!=h.which&&27!=h.which&&40!=h.which&&38!=h.which){var i=a(this).val();e||f.list.animate({opacity:0},g),e=!0,b=""===i?g:c,clearTimeout(d),d=setTimeout(function(){e=!1,f.list.animate({opacity:1},g),USL_Modal.closeShortcode(),f.list.find(".usl-modal-shortcode").each(function(){var b=a(this).find(".usl-modal-shortcode-title").text(),c=a(this).find(".description").text(),d=a(this).attr("data-code"),e=b+c+d;e.indexOf(i)<0?a(this).hide():a(this).show()})},b)}})},clearSearch:function(){f.search_input.val(""),f.list.find(".usl-modal-shortcode").show(),clearTimeout(d),f.list.css("opacity",1),e=!1},activateShortcode:function(a){var b=a.closest(".usl-modal-shortcode");b.hasClass("active")||(USL_Modal.closeShortcode(),f.active_shortcode=b,USL_Modal.openShortcode())},toggleAdvancedAtts:function(a){"Show advanced options"===a.text()?this.showAdvancedAtts(a):this.hideAdvancedAtts(a)},showAdvancedAtts:function(a){var b=a.siblings(".usl-modal-advanced-atts");b.show(),a.text("Hide advanced options")},hideAdvancedAtts:function(a){var b=a.siblings(".usl-modal-advanced-atts");b.hide(),a.text("Show advanced options")},preventWindowScroll:function(){f.list.bind("mousewheel",function(b){return a(this).scrollTop(a(this).scrollTop()-b.originalEvent.wheelDeltaY),!1})},filterByCategory:function(b){var c=b.attr("data-category"),d=f.list.find("li"),e=f.list.find("li.active");this.refresh(e),"all"===c?d.show():d.each(function(){c!==a(this).attr("data-category")?a(this).hide():a(this).show()})},list_height:function(){var a=f.wrap.innerHeight()-f.title.outerHeight(!0)-f.search.outerHeight(!0)-f.categories.outerHeight(!0)-f.wrap.find(".dashicons-leftright").outerHeight(!0)-f.footer.outerHeight(!0);f.list.height(a)},modify:function(a){a=a.trim();var b=a.match(/\s.*?(?==)/g),c=a.match(/"([^"]+)"/g),d=a.match(/\[(.*?)[\s|\]]/),e=null!==d[1]?d[1].trim():"",f=a.match(/\](.*)\[/),g=null!==f?f[1]:"",h={};if(g.length&&(h.content=g),this.setActiveShortcode(e),null!==b)for(var i=0;i<b.length;i++)h[b[i].trim()]=c[i].substring(1,c[i].length-1);this.populateShortcode(h),this.open(),this.openShortcode()},setActiveShortcode:function(b){f.list.find("li").each(function(){a(this).attr("data-code")===b&&(f.active_shortcode=a(this))})},populateShortcode:function(b){f.active_shortcode.find(".usl-modal-att-row").each(function(){var c=a(this).data("attObj"),d=c.$input.attr("name");"undefined"!=typeof b[d]&&c.setValue(b[d])})},closeShortcode:function(){f.active_shortcode.length&&(f.active_shortcode.removeClass("active open"),USL_Modal.hideAdvancedAtts(f.active_shortcode.find(".usl-modal-show-advanced-atts")),USL_Modal.refresh())},openShortcode:function(){if(f.active_shortcode.length){f.active_shortcode.addClass("active"),f.active_shortcode.hasClass("accordion-section")&&f.active_shortcode.addClass("open");var a=f.active_shortcode.position(),b=f.list.scrollTop(),c=a.top+b;f.list.stop().animate({scrollTop:c})}},open:function(b){c=b,g=!0,a(document).trigger("usl-modal-open"),f.wrap.show(),f.backdrop.show(),f.search.find('input[name="usl-modal-search"]').focus(),this.list_height(),a(document).trigger("usl-modal-open")},close:function(){g=!1,f.wrap.hide(),f.backdrop.hide(),this.refresh(),this.clearSearch(),f.list.find(".usl-mce-shortcode.active").removeClass("active open"),a(document).trigger("usl-modal-close")},update:function(){var b=f.list.find("li.active");if(0!==b.length&&this.validate()){this.sanitize();var d,e,g=b.find(".usl-modal-shortcode-form").serializeArray(),h=b.attr("data-code");if(d=USL_Data.all_shortcodes[h],e="["+h,g.length)for(i=0;i<g.length;i++)"content"!==g[i].name?g[i].value.length&&(e+=" "+g[i].name+'="'+g[i].value+'"'):c=g[i].value;e+="]",d.wrapping&&(e+=c+"[/"+h+"]"),this.close(),this.output=e,a(document).trigger("usl-modal-update")}},validate:function(){var b=!0;return f.active_shortcode.find(".usl-modal-att-row").each(function(){var c=a(this).data("attObj"),d=c.$container.attr("data-required"),e=c.$container.attr("data-validate"),f=c.getValue(),g=!0;return"1"===d&&!f&&b?(g=!1,b=!1,c.setInvalid("This field is required"),!0):f?(e.length&&(e=USL_Modal._stringToObject(e),a.each(e,function(a,d){switch(a){case"url":var e=/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gi;f.match(e)||(g=!1,b=!1,c.setInvalid("Please enter a valid URL"));break;case"maxchar":f.length>parseInt(d)&&(g=!1,b=!1,c.setInvalid(f.length-parseInt(d)+" too many characters."));break;case"minchar":f.length<parseInt(d)&&(g=!1,b=!1,c.setInvalid(parseInt(d)-f.length+" too few characters."));break;case"charonly":f.match(/[0-9]/)&&(g=!1,b=!1,c.setInvalid("No numbers please"));break;case"intonly":var h=f.match(/[0-9]+/);h&&h[0]===h.input||(g=!1,b=!1,c.setInvalid("Only numbers please"));break;default:throw new Error('USL -> Unsupported validation method "'+a+'" for the shortcode "'+c.shortcode+'" at field "'+c.fieldname+'"')}})),void(g&&c.setValid())):!0}),b},sanitize:function(){f.active_shortcode.find(".usl-modal-att-row").each(function(){var b=USL_Modal._stringToObject(a(this).attr("data-sanitize")),c=a(this).data("attObj"),d=c.getValue();return d.length?void(b&&a.each(b,function(a){switch(a){case"url":d.match(/https?:\/\//)||c.setValue("http://"+d);break;default:throw new Error('USL -> Unsupported sanitation method "'+a+'" for the shortcode "'+c.shortcode+'" at field "'+c.fieldname+'"')}})):!0})},refresh:function(){f.active_shortcode.find(".usl-modal-att-row").each(function(){var b=a(this).data("attObj");b._revert()})},_stringToObject:function(a){return"undefined"!=typeof a&&a.length?(a='"'+a.replace(/(:|,)/g,'"$1"')+'"',a=JSON.parse("{"+a+"}")):!1}};var h=function(a){b.apply(this,arguments),this.getValue=function(){return"textarea"===this.$input.prop("tagName")?this.$input.text():this.$input.val()},this.init(a)},j=function(a){b.apply(this,arguments),this.init(a)},k=function(a){b.apply(this,arguments),this.revert=function(){this.$input.iris("color",this.original_value)},this.setValue=function(a){this.$input.iris("color",a)},this.init(a)},l=function(a){b.apply(this,arguments),this.revert=function(){this.$slider.slider("value",this.original_value)},this.setValue=function(a){this.$input.val(a),this.$slider.slider("value",a)},this.init(a),this.$slider=this.$container.find(".usl-modal-att-slider")};a(function(){USL_Modal.init()}),a(window).load(function(){USL_Modal.load()}),a(window).resize(function(){USL_Modal.resize()})}(jQuery);var USL_Widget;!function(a){var b;USL_Widget={init:function(){this.binds()},binds:function(){a(document).on("click",".usl-widget-add-shortcode",function(){USL_Widget.open(a(this))}),a(document).on("usl-modal-update",function(){USL_Widget.update()}),a("#usl-modal-remove").click(function(){USL_Widget.remove()})},open:function(a){b=a.closest(".widget-content"),"no shortcode yet"!==b.find(".usl-widget-shortcode").text().trim().toLowerCase()?USL_Modal.modify(b.find(".usl-widget-shortcode").text()):USL_Modal.open()},update:function(){b.find(".usl-widget-shortcode").text(USL_Modal.output),b.find(".usl-widget-shortcode-field").val(USL_Modal.output),b.find(".usl-widget-add-shortcode").text("Modify / Remove Shortcode")},remove:function(){USL_Modal.close(),b.find(".usl-widget-shortcode").text("No shortcode yet"),b.find(".usl-widget-shortcode-field").val(""),b.find(".usl-widget-add-shortcode").text("Add Shortcode")}},a(function(){a("body").hasClass("widgets-php")&&USL_Widget.init()})}(jQuery);
//# sourceMappingURL=ultimate-shortcodes-library-admin.min.js.map