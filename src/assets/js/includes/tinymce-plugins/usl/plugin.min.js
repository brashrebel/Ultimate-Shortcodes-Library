var USL_tinymce;!function(a){var b,c,d,e,f=!1,g=0,h=!1,i="";USL_tinymce={init:function(){this.addToTinymce(),this.binds(),d=a("#wp-content-editor-container"),c=d.find(".wp-editor-area"),this.createLoader()},binds:function(){a(document).on("usl-modal-close",function(){USL_tinymce.close()}),a(document).on("usl-modal-update",function(){USL_tinymce.update()}),a(document).on("usl-modal-remove",function(){USL_tinymce.removeShortcode()}),a("#post").submit(function(b){USL_tinymce.submit(b,a(this))})},addToTinymce:function(){tinymce.PluginManager.add("usl",function(d){b=d,b.addShortcut("alt+shift+s","","usl-open"),b.addButton("usl",{icon:"usl-mce-icon",cmd:"usl-open",onPostRender:function(){var c=this;b.on("nodechange",function(b){var d=a(b.element).hasClass("usl-tinymce-shortcode-wrapper")?a(b.element):a(b.element).closest(".usl-tinymce-shortcode-wrapper"),e=d.length?!0:!1;i.length&&i.removeClass("active"),e&&(i=d,i.addClass("active")),c.active(e)})}}),b.addCommand("usl-open",function(){var c=b.selection.getContent(),d=b.selection.getNode();if(a(d).closest(".usl-tinymce-shortcode-wrapper").length||a(d).hasClass("usl-tinymce-shortcode-wrapper")){var e=a(d).hasClass("usl-tinymce-shortcode-wrapper")?a(d):a(d).closest(".usl-tinymce-shortcode-wrapper"),f=e.find(".usl-tinymce-shortcode-content").html(),g=a("<div />").append(e.clone()).html(),h=USL_tinymce.visualToLiteral(g);USL_Modal.showRemoveButton(),USL_Modal.modify(h,f)}else USL_Modal.hideRemoveButton(),USL_Modal.open(c)}),b.on("init show undo redo",USL_tinymce.loadVisual),a(document).on("usl-modal-update",USL_tinymce.loadVisual),b.on("hide",function(){var a=b.getContent({format:"numeric"});c.val(window.switchEditors.pre_wpautop(USL_tinymce.loadText(a)))})})},createLoader:function(){d.append('<div id="usl-tinymce-loader" class="hide"><div class="spinner"></div><div class="text">></div></div>'),e=a("#usl-tinymce-loader")},loadVisual:function(){if(USL_Data.do_render){var a=b.getContent();USL_MCECallbacks.convertLiteralToRendered(a,b)}},loadText:function(a){return a=USL_MCECallbacks.convertRenderedToLiteral(a,b),a=a.replace(/&#8203;/g,"")},visualToLiteral:function(b){var c=USL_MCECallbacks.getVisualAtts(b),d=USL_MCECallbacks.getVisualContent(b),e=USL_MCECallbacks.getVisualCode(b),f="["+e;return c&&a.each(c,function(a,b){b.length&&(f+=" "+a+'="'+b+'"')}),f+="]",d.length&&(f+=d+"[/"+e+"]"),f},close:function(){b.focus()},update:function(){this.removeShortcode(),b.insertContent(USL_Modal.output.all)},removeShortcode:function(){var c=b.selection.getNode(),d=a(c).hasClass("usl-tinymce-shortcode-wrapper")?a(c):a(c).closest(".usl-tinymce-shortcode-wrapper");d.remove(),USL_Modal.close()},loading:function(b){function c(){return f?void setTimeout(c,50):(e.addClass("hide"),a("#content-html").prop("disabled",!1),a("#content-tmce").prop("disabled",!1),void a("#wp-content-media-buttons").removeClass("disabled"))}if(b){f=!0,setTimeout(function(){f=!1},1500);var d=USL_Data.loading_messages,h=Math.floor(Math.random()*d.length);if(h==g)for(;h==g;)h=Math.floor(Math.random()*d.length);g=h,e.find(".text").html(d[h]),e.removeClass("hide"),a("#content-html").prop("disabled",!0),a("#content-tmce").prop("disabled",!0),a("#wp-content-media-buttons").addClass("disabled")}else c()},submit:function(a,c){if(!h){h=!0,a.preventDefault();var d=b.getContent();b.on("PostProcess",function(a){a.content=USL_tinymce.loadText(d)}),c.submit()}}},a(function(){USL_tinymce.init()})}(jQuery);
//# sourceMappingURL=plugin.min.js.map